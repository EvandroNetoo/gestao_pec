{% load static %}

<!DOCTYPE html>
<html lang="pt-br">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>

            {% block title %}

            {% endblock title %}

            GestÃ£o â€” PEC

        </title>

        <link href="https://cdn.jsdelivr.net/npm/daisyui@5"
              rel="stylesheet"
              type="text/css"
              hx-preserve="true"
              id="daisyui-css" />
        <link rel="icon"
              href="{% static 'img/logo_gestao_pec.png' %}"
              type="image/png"
              hx-preserve="true"
              id="favicon">
        <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"
                hx-preserve="true"
                id="tailwindcss-js"></script>
        <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.8/dist/htmx.min.js"
                integrity="sha384-/TgkGk7p307TH7EXJDuUlgG3Ce1UVolAOFopFekQkkXihi5u/6OCvVKyz1W+idaz"
                crossorigin="anonymous"
                hx-preserve="true"
                id="htmx-js"></script>

        <link href="{% static 'css/styles.css' %}"
              rel="stylesheet"
              type="text/css"
              hx-preserve="true"
              id="styles-css" />

        {% block extrahead %}

        {% endblock extrahead %}

    </head>

    <body class="bg-base-200 min-h-screen" hx-boost="true">

        <div class="drawer lg:drawer-open">
            <input id="drawer-gestao" type="checkbox" class="drawer-toggle" />

            <div class="drawer-content flex flex-col">

                <!-- Navbar -->
                <div class="navbar bg-base-100 shadow-sm lg:hidden px-2">
                    <div class="navbar-start">
                        <label for="drawer-gestao" class="btn btn-ghost btn-sm btn-square">
                            <svg xmlns="http://www.w3.org/2000/svg"
                                 class="h-5 w-5"
                                 fill="none"
                                 viewBox="0 0 24 24"
                                 stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                            </svg>
                        </label>
                    </div>
                    <div class="navbar-center">
                        <span class="font-bold text-base">GestÃ£o PEC</span>
                    </div>
                    <div class="navbar-end">
                        <a href="{% url 'home' %}"
                           class="btn btn-ghost btn-sm btn-circle"
                           title="Agenda PÃºblica">ğŸŒ</a>
                    </div>
                </div>

                <!-- ConteÃºdo principal -->
                <main class="flex-1 p-3 sm:p-4 lg:p-6">

                    {% if messages %}

                        <div class="mb-4 space-y-2">

                            {% for message in messages %}

                                <c-alert type="{{ message.tags }}">
                                    {{ message }}
                                </c-alert>

                            {% endfor %}

                        </div>

                    {% endif %}

                    {% block content %}

                    {% endblock content %}

                </main>
            </div>

            <!-- Sidebar -->
            <div class="drawer-side">
                <label for="drawer-gestao"
                       aria-label="fechar sidebar"
                       class="drawer-overlay"></label>
                <aside class="bg-base-100 min-h-full w-72 p-4 flex flex-col">

                    <div class="flex items-center gap-2 mb-6 px-2">
                        <img src="{% static 'img/ifes/colatina-horizontal-cor.png' %}"
                             alt="IFES"
                             class="h-10 w-auto"
                             hx-preserve="true"
                             id="sidebar-logo">
                        <span class="font-bold text-sm">GestÃ£o PEC</span>
                    </div>

                    <ul class="menu menu-md w-full flex-1">
                        <li>
                            <a href="{% url 'dashboard' %}" class=" 
                                {% if request.resolver_match.url_name == 'dashboard' %}menu-active{% endif %}">ğŸ“Š
                            Dashboard</a>
                        </li>

                        <li class="menu-title mt-4">Cadastros</li>
                        <li>
                            <a href="{% url 'semestre_list' %}" class=" 
                                {% if 'semestre' in request.resolver_match.url_name %}menu-active{% endif %}">ğŸ“†
                            Semestres</a>
                        </li>
                        <li>
                            <a href="{% url 'turma_list' %}" class=" 
                                {% if 'turma' in request.resolver_match.url_name %}menu-active{% endif %}">ğŸ«
                            Turmas</a>
                        </li>
                        <li>
                            <a href="{% url 'oficina_list' %}" class=" 
                                {% if 'oficina' in request.resolver_match.url_name %}menu-active{% endif %}">ğŸ”§
                            Oficinas</a>
                        </li>
                        <li>
                            <a href="{% url 'aluno_list' %}" class=" 
                                {% if 'aluno' in request.resolver_match.url_name %}menu-active{% endif %}">ğŸ‘¤
                            Alunos</a>
                        </li>
                        <li>
                            <a href="{% url 'evento_list' %}" class=" 
                                {% if 'evento' in request.resolver_match.url_name %}menu-active{% endif %}">ğŸ“…
                            Eventos</a>
                        </li>

                        <li class="menu-title mt-4">RelatÃ³rios</li>
                        <li>
                            <a href="{% url 'relatorio_geral' %}" class=" 
                                {% if request.resolver_match.url_name == 'relatorio_geral' %}menu-active{% endif %}">ğŸ“ˆ Resumo
                            Geral</a>
                        </li>
                        <li>
                            <a href="{% url 'relatorio_turma' %}" class=" 
                                {% if request.resolver_match.url_name == 'relatorio_turma' %}menu-active{% endif %}">ğŸ“‹ Por
                            Turma</a>
                        </li>
                        <li>
                            <a href="{% url 'relatorio_evento' %}" class=" 
                                {% if request.resolver_match.url_name == 'relatorio_evento' %}menu-active{% endif %}">ğŸ“Š
                            Por Evento</a>
                        </li>

                        <div class="divider"></div>
                        <li>
                            <a href="{% url 'home' %}">ğŸŒ Agenda PÃºblica</a>
                        </li>
                    </ul>

                    <div class="px-2 py-4 text-xs text-base-content/50">{{ request.user.get_full_name|default:request.user.email }}</div>
                </aside>
            </div>
        </div>

        <script>
            if (!document.body.hasAttribute('data-drawer-listener')) {
                document.body.setAttribute('data-drawer-listener', 'true');
                document.body.addEventListener('htmx:afterSwap', function(evt) {
                    const drawer = document.getElementById('drawer-gestao');
                    if (drawer && drawer.checked) {
                        drawer.checked = false;
                    }
                });
            }
        </script>
    </body>

</html>
